



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="EVAdb - Exome Variant Analysis database documentation">
      
      
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-5.5.14">
    
    
      
        <title>Variant Annotation and Upload - EVAdb</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.d3202873.min.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ff0a5ce4.min.css">
      
      
        
        
        <meta name="theme-color" content="#2094f3">
      
    
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/default.min.css">
    
    
      
    
    
  </head>
  
  
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="blue" data-md-color-accent="">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#variant-annotation" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="../.." title="EVAdb" class="md-header-nav__button md-logo" aria-label="EVAdb">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            EVAdb
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              Variant Annotation and Upload
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active">
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header-nav__source">
        
<a href="https://github.com/brand-fabian/evadb-docs/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    EVAdb Docs
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
        
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="EVAdb" class="md-nav__button md-logo" aria-label="EVAdb">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    EVAdb
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/brand-fabian/evadb-docs/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    EVAdb Docs
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../architecture/" title="Software Architecture" class="md-nav__link">
      Software Architecture
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Installation
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Installation" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        <span class="md-nav__icon md-icon"></span>
        Installation
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-1" type="checkbox" id="nav-3-1">
    
    <label class="md-nav__link" for="nav-3-1">
      Docker
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Docker" data-md-level="2">
      <label class="md-nav__title" for="nav-3-1">
        <span class="md-nav__icon md-icon"></span>
        Docker
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../installation/docker/prerequisites/" title="Prerequisites" class="md-nav__link">
      Prerequisites
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../installation/docker/download/" title="Download" class="md-nav__link">
      Download
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../installation/docker/configuration/" title="Configuration" class="md-nav__link">
      Configuration
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../installation/docker/build/" title="Build" class="md-nav__link">
      Build
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../installation/docker/run/" title="First Start" class="md-nav__link">
      First Start
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-2" type="checkbox" id="nav-3-2">
    
    <label class="md-nav__link" for="nav-3-2">
      Native Installation
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Native Installation" data-md-level="2">
      <label class="md-nav__title" for="nav-3-2">
        <span class="md-nav__icon md-icon"></span>
        Native Installation
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../installation/native/" title="Installation" class="md-nav__link">
      Installation
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4" checked>
    
    <label class="md-nav__link" for="nav-4">
      Administration Guide
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Administration Guide" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        <span class="md-nav__icon md-icon"></span>
        Administration Guide
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../quick-start/" title="Quick Start" class="md-nav__link">
      Quick Start
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../sample/" title="Sample Management" class="md-nav__link">
      Sample Management
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Variant Annotation and Upload
        <span class="md-nav__icon md-icon"></span>
      </label>
    
    <a href="./" title="Variant Annotation and Upload" class="md-nav__link md-nav__link--active">
      Variant Annotation and Upload
    </a>
    
      
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#data-locality" class="md-nav__link">
    Data Locality
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#scripts" class="md-nav__link">
    Scripts
  </a>
  
    <nav class="md-nav" aria-label="Scripts">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#importvcfsh" class="md-nav__link">
    importVCF.sh
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../user/" title="User Management" class="md-nav__link">
      User Management
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../disease/" title="Diseases and Disease Groups" class="md-nav__link">
      Diseases and Disease Groups
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../projects.md" title="Projects and Cooperations" class="md-nav__link">
      Projects and Cooperations
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#data-locality" class="md-nav__link">
    Data Locality
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#scripts" class="md-nav__link">
    Scripts
  </a>
  
    <nav class="md-nav" aria-label="Scripts">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#importvcfsh" class="md-nav__link">
    importVCF.sh
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/brand-fabian/evadb-docs/edit/master/docs/administration/annotation.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                  
                
                
                <h1 id="variant-annotation">Variant Annotation</h1>
<p>To upload a vcf file, first it must be annotated using a custom perl pipeline.</p>
<div class="admonition warning">
<p class="admonition-title">Docker</p>
<p>The following documentation is specific to the Docker version of EVAdb.
When using the bare-metal installation your mileage may vary, the general
steps remain the same however.</p>
</div>
<details class="- note"><summary>VEP</summary><p>It is intended to switch from the custom annotation pipeline
to <a href="http://grch37.ensembl.org/info/docs/tools/vep/index.html">VEP</a>. This documentation will be update accordingly. </p>
</details>
<p>Annotation is performed at the same time as the actual data upload. For this,
we use a set of intermittent annotation and insert steps. Each step performs
annotation for things like genes and transcripts based on data from the
annotation tables present in the database. For ease of use, the annotation
container uses the main script <code>externalPipelineImport.pl</code> as entrypoint
interface. To start the import process, the script needs access to a vcf file,
the sample id of the sample in the database and the settings name
(<code>hg19_plus</code>).</p>
<div class="admonition warning">
<p class="admonition-title">References with/without chr tags</p>
<p>Depending on the Reference that you use for variant calling and alignment,
the contigs will be either have the <code>chr</code> prefix (e.g. <code>chr1</code>), or not
(e.g. <code>1</code>). EVAdb uses the UCSC versions of all contigs, so the prefix
<strong>must</strong> be present.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Data Paths</p>
<p>The paths to your data most likely differ between the container and the
outside world. Make sure to adjust the paths for your mountpoint (
the <code>DATA_DIR</code> configuration variable). Data is mounted to <code>/data</code>
inside the container.</p>
</div>
<p>To import a single or multi-sample vcf file, the following command line is
sufficient.</p>
<div class="highlight"><pre><span></span><code>docker-compose run annotation -vcf &lt;VCF_FILE&gt; <span class="se">\</span>
  -sample <span class="s2">&quot;&lt;SAMPLE&gt;&quot;</span> <span class="se">\</span>
  -se hg19_plus
</code></pre></div>

<details class="- note"><summary>Inside the container</summary><p>If you want to open a shell inside the annotation container first, the
command can be run as:</p>
<div class="highlight"><pre><span></span><code>docker-compose run annotation bash <span class="c1"># or the corresponding docker exec</span>
perl /pipeline/externalPipelineImport.pl -vcf &lt;VCF_FILE&gt; <span class="se">\</span>
  -sample <span class="s2">&quot;&lt;SAMPLE&gt;&quot;</span> <span class="se">\</span>
  -se hg19_plus
</code></pre></div>

</details>
<p>The <code>externalPipelineImport.pl</code> draws most of its runtime information off the
<code>current.config.xml</code> file. If you do run on bare-metal make sure to set the
paths in this file such that tool directories and data locations are what is
required by the tool.</p>
<h2 id="data-locality">Data Locality</h2>
<p>With the current iteration of EVAdb and the Docker images all data must be
local to the EVAdb server. As noticed in the
<a href="../../installation/docker/configuration/">configuration part</a>, all data
directories are entered as docker volume and put through to the container.
As such, the data paths differ between container and host. Nevertheless, it
is not currently possible to upload samples or data from remote hosts to
the machine in excess of what is possible through the use of the web interface.</p>
<p>We recommend a data partition or disk with enough storage for your NGS
experiments to host this data. This brings two advantages, first you spare
the database disk from additional stress (it will be under heavy load on sample
import) and additionally you can use cheaper mass storage media to host the 
bulk (e.g. <code>.bam</code> or <code>.fq.gz</code>) of your data.</p>
<h2 id="scripts">Scripts</h2>
<h3 id="importvcfsh">importVCF.sh</h3>
<p>To upload many samples in quick succession, we use the following script.</p>
<div class="admonition error">
<p class="admonition-title">Breakage - Adjust before use</p>
<p>This script is provided as an example for a complete import process. As it
is written with the specific configuration of our site in mind it will most
likely not work without changes on other systems.</p>
</div>
<div class="highlight"><pre><span></span><code><span class="ch">#! /bin/bash</span>
<span class="c1"># vim: ts=4 sw=4 expandtab</span>

<span class="nv">EVADB_DIR</span><span class="o">=</span><span class="s2">&quot;/home/evadb&quot;</span>
<span class="nv">INPUT_DIR</span><span class="o">=</span><span class="s2">&quot;/gluster/gluster01/share/exome&quot;</span>

<span class="k">function</span> usage <span class="o">{</span>
    <span class="nb">echo</span> -e <span class="s2">&quot;importVCF.sh\n\nImport all VCFs of a given Flow Cell into the EVAdb running in </span><span class="nv">$EVADB_DIR</span><span class="s2"> as\ndocker version. Files are searched for in </span><span class="nv">$INPUT_DIR</span><span class="s2">.\n\nParameters:\n\n\t-f\t\tFlow Cell to import.\n\t-h\t\tPrint help.&quot;</span>   
<span class="o">}</span>

<span class="nv">PW_FILE</span><span class="o">=</span><span class="s2">&quot;/home/evadb/.env&quot;</span>
<span class="nv">ROOT_PW</span><span class="o">=</span><span class="k">$(</span>grep MYSQL_ROOT_PASSWORD <span class="nv">$PW_FILE</span> <span class="p">|</span> cut -d<span class="s2">&quot;=&quot;</span> -f2<span class="k">)</span>

<span class="k">while</span> <span class="nb">getopts</span> <span class="s2">&quot;f:h&quot;</span> arg<span class="p">;</span> <span class="k">do</span>
    <span class="k">case</span> <span class="nv">$arg</span> in
        f<span class="o">)</span>
            <span class="nv">FLOW_CELL</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">OPTARG</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">;;</span>
        h<span class="o">)</span>
            usage
            <span class="nb">exit</span> <span class="m">0</span>
            <span class="p">;;</span>
    <span class="k">esac</span>
<span class="k">done</span>

<span class="k">if</span> <span class="o">[</span> -z <span class="s2">&quot;</span><span class="nv">$FLOW_CELL</span><span class="s2">&quot;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
    <span class="nb">echo</span> -e <span class="s2">&quot;Error: Please supply a flow cell id.&quot;</span>
    usage
    <span class="nb">exit</span> <span class="m">1</span>
<span class="k">fi</span>

<span class="nb">echo</span> -e <span class="s2">&quot;Searching </span><span class="nv">$INPUT_DIR</span><span class="s2">/</span><span class="nv">$FLOW_CELL</span><span class="s2">/&quot;</span>
<span class="nv">ESC_INPUT</span><span class="o">=</span><span class="k">$(</span><span class="nb">echo</span> <span class="s2">&quot;</span><span class="si">${</span><span class="nv">INPUT_DIR</span><span class="si">}</span><span class="s2">&quot;</span> <span class="p">|</span> sed -e <span class="s1">&#39;s/[](&amp;|$|\|{|}).*[\^]/\\&amp;/g&#39;</span><span class="k">)</span>

<span class="nb">cd</span> <span class="nv">$EVADB_DIR</span>
<span class="k">for</span> f in <span class="k">$(</span>find <span class="s2">&quot;</span><span class="nv">$INPUT_DIR</span><span class="s2">/</span><span class="nv">$FLOW_CELL</span><span class="s2">/&quot;</span> -name <span class="s2">&quot;DE*vcf.gz&quot;</span><span class="k">)</span>
<span class="k">do</span>
    <span class="nv">BASENAME</span><span class="o">=</span><span class="k">$(</span>basename <span class="nv">$f</span><span class="k">)</span>
    <span class="nv">DIRNAME</span><span class="o">=</span><span class="k">$(</span>dirname <span class="nv">$f</span><span class="k">)</span>
    <span class="nv">SAMPLE</span><span class="o">=</span><span class="si">${</span><span class="nv">BASENAME</span><span class="p">%%.*</span><span class="si">}</span>
    <span class="nv">VCF</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$DIRNAME</span><span class="s2">/</span><span class="nv">$SAMPLE</span><span class="s2">.chr.vcf&quot;</span>

    <span class="nv">QUERY</span><span class="o">=</span><span class="s2">&quot;select * from sample where name LIKE &#39;%</span><span class="nv">$SAMPLE</span><span class="s2">%&#39; or pedigree LIKE &#39;%</span><span class="nv">$SAMPLE</span><span class="s2">%&#39; or foreignid LIKE &#39;%</span><span class="nv">$SAMPLE</span><span class="s2">%&#39;;&quot;</span>
    <span class="nv">SAMPLE_IN_DB</span><span class="o">=</span><span class="k">$(</span>docker-compose <span class="nb">exec</span> db mysql -u root -p<span class="nv">$ROOT_PW</span> -e <span class="s2">&quot;</span><span class="nv">$QUERY</span><span class="s2">&quot;</span> exomehg19 <span class="p">|</span> grep <span class="s2">&quot;</span><span class="nv">$SAMPLE</span><span class="s2">&quot;</span><span class="k">)</span>

    <span class="k">if</span> <span class="o">[[</span> -n <span class="s2">&quot;</span><span class="nv">$SAMPLE_IN_DB</span><span class="s2">&quot;</span> <span class="o">]]</span><span class="p">;</span>
    <span class="k">then</span>
        <span class="nb">echo</span> <span class="s2">&quot;Annotating and Importing </span><span class="nv">$SAMPLE</span><span class="s2">..&quot;</span>

        <span class="nb">echo</span> -e <span class="s2">&quot;\tAdding chr prefix...&quot;</span>
        zcat <span class="nv">$f</span> <span class="p">|</span> awk <span class="s1">&#39;{ if ( $1 ~ &quot;#&quot; ) { print $0 } else { print &quot;chr&quot;$0 } }&#39;</span> &gt; <span class="nv">$VCF</span>

        <span class="nb">echo</span> -e <span class="s2">&quot;\tImporting </span><span class="nv">$SAMPLE</span><span class="s2"> into evadb...&quot;</span>
        docker-compose run annotation -vcf <span class="s2">&quot;</span><span class="si">${</span><span class="nv">VCF</span><span class="p">/</span><span class="nv">$ESC_INPUT</span><span class="p">/</span><span class="se">\/</span><span class="nv">data</span><span class="si">}</span><span class="s2">&quot;</span> -sample <span class="s2">&quot;</span><span class="nv">$SAMPLE</span><span class="s2">&quot;</span> -se hg19_plus

        <span class="nb">echo</span> -e <span class="s2">&quot;\tCleanup...&quot;</span>
        rm <span class="nv">$VCF</span>
    <span class="k">else</span>
        <span class="nb">echo</span> -e <span class="s2">&quot;Could not find </span><span class="nv">$SAMPLE</span><span class="s2"> in database. Have you create the sample using \&quot;Import external samples\&quot;?&quot;</span>
    <span class="k">fi</span>
<span class="k">done</span>
<span class="nb">cd</span> -
</code></pre></div>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../sample/" title="Sample Management" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Sample Management
              </div>
            </div>
          </a>
        
        
          <a href="../user/" title="User Management" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                User Management
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/vendor.2d1db4bd.min.js"></script>
      <script src="../../assets/javascripts/bundle.6627ddf3.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents"}</script>
      
      <script>
        app = initialize({
          base: "../..",
          features: [],
          search: Object.assign({
            worker: "../../assets/javascripts/worker/search.5eca75d3.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/tablesort/5.2.1/tablesort.min.js"></script>
      
        <script src="../../js/tables.js"></script>
      
        <script src="../../js/config.js"></script>
      
    
  </body>
</html>